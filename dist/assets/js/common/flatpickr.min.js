"use strict";function ready(t){"loading"!==document.readyState?t():document.addEventListener("DOMContentLoaded",t)}var index,current;ready(function(){xhrEvents()});var fp,events=[];function xhrEvents(){xhrLoadJSON(["../../json/events.json"],1e3,getEvents)}function getEvents(){events=this[0].sort(sortArrayByProperties("asc","start")),initFlatpickr(),setEventListListeners()}function initFlatpickr(){var t=document.querySelector("#flatpickr-events");fp=flatpickr(t,{inline:!0,allowInput:!1,mode:"multiple",disableMobile:!1,minDate:"2020-01-01",maxDate:"2020-12-31",locale:{firstDayOfWeek:1},shorthandCurrentMonth:!1,weekNumbers:!1,dateFormat:"Y-m-d",altFormat:"Y-m-d",ariaDateFormat:"Y-m-d",time_24hr:!0,enable:["2020-01-01"],onReady:function(){setEvents(),setCalendarListeners()},onOpen:function(){},onMonthChange:function(){setEvents(),setCalendarListeners()},onYearChange:function(){setEvents(),setCalendarListeners()},onChange:function(){setEvents(),setCalendarListeners()},onDayCreate:function(t,e,n,r){for(var s="events-".concat(r.getAttribute("aria-label")),o='<div id="'.concat(s,'" class="events">'),i=0;i<events.length;++i)if("n"!==events[i].active)for(var a,l=events[i].id,c=0;c<events[i].schedule.length;++c){-1!==events[i].schedule[c].date.indexOf(flatpickr.formatDate(r.dateObj,"Y-m-d"))&&(r.classList.add("cool"),a=0===c?" alpha":" beta",o+='<span id="event-'.concat(l,'" class="event').concat(a,'"></span>'))}o+="</div>";var d=html2fragment(o);r.appendChild(d)}})}function drawEventList(){for(var t="<h3>Events</h3>",e=0;e<events.length;++e)"n"!==events[e].active&&(t+='<div class="event-list" aria-label="'.concat(events[e].start,'"><strong>').concat(events[e].name,"</strong><br>").concat(events[e].start," to ").concat(events[e].end,"</div>"));document.querySelector("#flatpickr-list").innerHTML=t}function drawEventOutput(){var t=this.getAttribute("aria-label");updateEventList(t),updateEventDetails(t)}function updateEventList(t){var e=t.split("-"),n=(parseInt(e[0],10),parseInt(e[1],10));parseInt(e[3],10);fp.changeMonth(n-1,!1)}function updateEventDetails(t){for(var e="",n=0;n<events.length;++n)if("n"!==events[n].active&&-1!==events[n].schedule.map(function(t){return t.date}).indexOf(t)){for(var r="".concat(events[n].location.venue,"<br>").concat(events[n].location.address,"<br>").concat(events[n].location.city,", ").concat(events[n].location.province,"<br>").concat(events[n].location.postal_code),s="Adult $".concat(events[n].registration.entry_fee.adult,"<br>Junior $").concat(events[n].registration.entry_fee.junior,"<br>Senior $").concat(events[n].registration.entry_fee.senior,"<br>GM/WGM/IM/WIM $").concat(events[n].registration.entry_fee.titled.gm,"<br>FM $").concat(events[n].registration.entry_fee.titled.fm,"<br>CM $").concat(events[n].registration.entry_fee.titled.cm,"<br>NM $").concat(events[n].registration.entry_fee.titled.nm),o="y"===events[n].sections?"Sectional ":"",i=["ch","Championship","inv","Invitational","m","Match","op","Open","rr","Round Robin","tt","Team Tournament"],a=i[i.indexOf(events[n].format.type)+1],l="",c=0;c<events[n].schedule.length;++c)l+="<li>Round ".concat(c+1,": ").concat(events[n].schedule[c].date," (").concat(events[n].schedule[c].time,")</li>");var d=[],g="y"===events[n].format.rated.cfc?"CFC":"",v="y"===events[n].format.rated.fide?"FIDE":"";g&&d.push(g),v&&d.push(v),d=d.join(" & ")||"Unrated";var m='\n        <form id="reg_event" method="post" action="/events-post">\n          <input type="hidden" id="id" name="id" value="'.concat(events[n].id,'">\n          <button type="submit" form="reg_event" class="button button__action button__wide button__xl">Enter Event</button>\n        </form>');("inv"===events[n].format.type||"tt"===events[n].format.type||events[n].start<dateToIsoDate())&&(m="");var f="<strong>Onsite Registration</strong><br>Add $".concat(events[n].registration.on_site," to your entry fee<br><br>");"n"===events[n].registration.on_site&&(f="<strong>No Onsite Registration</strong><br>"),e+='\n        <div class="card">\n          <div class="card__logo"></div>\n          <div class="card__description">\n            <div class="card__description--title">\n              '.concat(events[n].name,'\n            </div>\n            <div class="card__description--subtitle">\n              ').concat(events[n].start," to ").concat(events[n].end,'\n            </div>\n            <div class="card__description--text">\n              ').concat(r,'\n            </div>\n            <div class="card__description--media icon">\n              <span class="icon svg-icon svg-baseline icon__feature"><svg width="100%" height="100%" viewBox="0 0 258 165" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:10;"><g transform="matrix(1,0,0,1,-16.387,-51.475)"><g transform="matrix(1.11437,0,0,1.11437,-60.0578,-109.811)"><g id="line-1" serif:id="line 1" transform="matrix(1,0,0,1,18.8448,2.69211)"><g transform="matrix(1,0,0,1,165.477,204.693)"><path d="M0,79.482L44.708,9.377L93.97,79.482L110.114,0L31.461,77.825L0,21.112" style="fill:none;stroke:rgb(231,193,87);stroke-width:11.22px;"/></g><g transform="matrix(1,0,0,1,256.872,183.503)"><path d="M0,39.725C-1.55,15.865 -21.397,-3.011 -45.649,-3.011C-70.913,-3.011 -91.395,17.471 -91.395,42.736" style="fill:none;stroke:rgb(231,193,87);stroke-width:11.22px;"/></g><g transform="matrix(1,0,0,1,165.477,204.693)"><path d="M0,79.482L-44.708,9.377L-93.97,79.482L-110.114,0L-31.461,77.825L0,21.112" style="fill:none;stroke:rgb(231,193,87);stroke-width:11.22px;"/></g><g transform="matrix(1,0,0,1,74.0835,183.503)"><path d="M0,39.725C1.55,15.865 21.396,-3.011 45.648,-3.011C70.912,-3.011 91.394,17.471 91.394,42.736" style="fill:none;stroke:rgb(231,193,87);stroke-width:11.22px;"/></g><g transform="matrix(1,0,0,1,210.185,169.303)"><path d="M0,44.709C0,20.017 -20.017,0 -44.708,0C-69.398,0 -89.416,20.017 -89.416,44.709" style="fill:none;stroke:rgb(231,193,87);stroke-width:11.22px;"/></g><g transform="matrix(0,1,1,0,165.477,147.65)"><ellipse cx="10.827" cy="0" rx="10.827" ry="10.827" style="fill:none;stroke:rgb(231,193,87);stroke-width:11.22px;"/></g><g transform="matrix(1,0,0,1,71.5068,284.175)"><path d="M0,0L187.94,0" style="fill:none;stroke:rgb(231,193,87);stroke-width:11.22px;"/></g></g></g></g></svg></span>\n              <span class="icon svg-icon svg-baseline icon__feature"><svg width="100%" height="100%" viewBox="0 0 258 165" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:10;"><g transform="matrix(1,0,0,1,-16.387,-51.475)"><g transform="matrix(1.11437,0,0,1.11437,-60.0578,-109.811)"><g id="line-1" serif:id="line 1" transform="matrix(1,0,0,1,18.8448,2.69211)"><g transform="matrix(1,0,0,1,165.477,204.693)"><path d="M0,79.482L44.708,9.377L93.97,79.482L110.114,0L31.461,77.825L0,21.112" style="fill:none;stroke:rgb(231,193,87);stroke-width:11.22px;"/></g><g transform="matrix(1,0,0,1,256.872,183.503)"><path d="M0,39.725C-1.55,15.865 -21.397,-3.011 -45.649,-3.011C-70.913,-3.011 -91.395,17.471 -91.395,42.736" style="fill:none;stroke:rgb(231,193,87);stroke-width:11.22px;"/></g><g transform="matrix(1,0,0,1,165.477,204.693)"><path d="M0,79.482L-44.708,9.377L-93.97,79.482L-110.114,0L-31.461,77.825L0,21.112" style="fill:none;stroke:rgb(231,193,87);stroke-width:11.22px;"/></g><g transform="matrix(1,0,0,1,74.0835,183.503)"><path d="M0,39.725C1.55,15.865 21.396,-3.011 45.648,-3.011C70.912,-3.011 91.394,17.471 91.394,42.736" style="fill:none;stroke:rgb(231,193,87);stroke-width:11.22px;"/></g><g transform="matrix(1,0,0,1,210.185,169.303)"><path d="M0,44.709C0,20.017 -20.017,0 -44.708,0C-69.398,0 -89.416,20.017 -89.416,44.709" style="fill:none;stroke:rgb(231,193,87);stroke-width:11.22px;"/></g><g transform="matrix(0,1,1,0,165.477,147.65)"><ellipse cx="10.827" cy="0" rx="10.827" ry="10.827" style="fill:none;stroke:rgb(231,193,87);stroke-width:11.22px;"/></g><g transform="matrix(1,0,0,1,71.5068,284.175)"><path d="M0,0L187.94,0" style="fill:none;stroke:rgb(231,193,87);stroke-width:11.22px;"/></g></g></g></g></svg></span>\n              <span class="icon svg-icon svg-baseline icon__feature"><svg width="100%" height="100%" viewBox="0 0 258 165" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:10;"><g transform="matrix(1,0,0,1,-16.387,-51.475)"><g transform="matrix(1.11437,0,0,1.11437,-60.0578,-109.811)"><g id="line-1" serif:id="line 1" transform="matrix(1,0,0,1,18.8448,2.69211)"><g transform="matrix(1,0,0,1,165.477,204.693)"><path d="M0,79.482L44.708,9.377L93.97,79.482L110.114,0L31.461,77.825L0,21.112" style="fill:none;stroke:rgb(231,193,87);stroke-width:11.22px;"/></g><g transform="matrix(1,0,0,1,256.872,183.503)"><path d="M0,39.725C-1.55,15.865 -21.397,-3.011 -45.649,-3.011C-70.913,-3.011 -91.395,17.471 -91.395,42.736" style="fill:none;stroke:rgb(231,193,87);stroke-width:11.22px;"/></g><g transform="matrix(1,0,0,1,165.477,204.693)"><path d="M0,79.482L-44.708,9.377L-93.97,79.482L-110.114,0L-31.461,77.825L0,21.112" style="fill:none;stroke:rgb(231,193,87);stroke-width:11.22px;"/></g><g transform="matrix(1,0,0,1,74.0835,183.503)"><path d="M0,39.725C1.55,15.865 21.396,-3.011 45.648,-3.011C70.912,-3.011 91.394,17.471 91.394,42.736" style="fill:none;stroke:rgb(231,193,87);stroke-width:11.22px;"/></g><g transform="matrix(1,0,0,1,210.185,169.303)"><path d="M0,44.709C0,20.017 -20.017,0 -44.708,0C-69.398,0 -89.416,20.017 -89.416,44.709" style="fill:none;stroke:rgb(231,193,87);stroke-width:11.22px;"/></g><g transform="matrix(0,1,1,0,165.477,147.65)"><ellipse cx="10.827" cy="0" rx="10.827" ry="10.827" style="fill:none;stroke:rgb(231,193,87);stroke-width:11.22px;"/></g><g transform="matrix(1,0,0,1,71.5068,284.175)"><path d="M0,0L187.94,0" style="fill:none;stroke:rgb(231,193,87);stroke-width:11.22px;"/></g></g></g></g></svg></span>\n              <span class="icon svg-icon svg-baseline icon__feature"><svg width="100%" height="100%" viewBox="0 0 258 165" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:10;"><g transform="matrix(1,0,0,1,-16.387,-51.475)"><g transform="matrix(1.11437,0,0,1.11437,-60.0578,-109.811)"><g id="line-1" serif:id="line 1" transform="matrix(1,0,0,1,18.8448,2.69211)"><g transform="matrix(1,0,0,1,165.477,204.693)"><path d="M0,79.482L44.708,9.377L93.97,79.482L110.114,0L31.461,77.825L0,21.112" style="fill:none;stroke:rgb(231,193,87);stroke-width:11.22px;"/></g><g transform="matrix(1,0,0,1,256.872,183.503)"><path d="M0,39.725C-1.55,15.865 -21.397,-3.011 -45.649,-3.011C-70.913,-3.011 -91.395,17.471 -91.395,42.736" style="fill:none;stroke:rgb(231,193,87);stroke-width:11.22px;"/></g><g transform="matrix(1,0,0,1,165.477,204.693)"><path d="M0,79.482L-44.708,9.377L-93.97,79.482L-110.114,0L-31.461,77.825L0,21.112" style="fill:none;stroke:rgb(231,193,87);stroke-width:11.22px;"/></g><g transform="matrix(1,0,0,1,74.0835,183.503)"><path d="M0,39.725C1.55,15.865 21.396,-3.011 45.648,-3.011C70.912,-3.011 91.394,17.471 91.394,42.736" style="fill:none;stroke:rgb(231,193,87);stroke-width:11.22px;"/></g><g transform="matrix(1,0,0,1,210.185,169.303)"><path d="M0,44.709C0,20.017 -20.017,0 -44.708,0C-69.398,0 -89.416,20.017 -89.416,44.709" style="fill:none;stroke:rgb(231,193,87);stroke-width:11.22px;"/></g><g transform="matrix(0,1,1,0,165.477,147.65)"><ellipse cx="10.827" cy="0" rx="10.827" ry="10.827" style="fill:none;stroke:rgb(231,193,87);stroke-width:11.22px;"/></g><g transform="matrix(1,0,0,1,71.5068,284.175)"><path d="M0,0L187.94,0" style="fill:none;stroke:rgb(231,193,87);stroke-width:11.22px;"/></g></g></g></g></svg></span>\n            </div>\n            <ul class="card__description--list">\n              ').concat(l,'\n            </ul>\n            <div class="card__description--text">\n              <strong>Organizer</strong><br>').concat(events[n].organizer[0].name.first," ").concat(events[n].organizer[0].name.last,"<br>").concat(events[n].organizer[0].email,"<br><br>\n              <strong>Tournament Director</strong><br>").concat(events[n].tournament_director[0].name.first," ").concat(events[n].tournament_director[0].name.last,"<br>").concat(events[n].tournament_director[0].email,"<br><br>\n              <strong>Format / Time Control</strong><br>").concat(a," ").concat(o,"(").concat(events[n].schedule.length," rounds)<br>").concat(events[n].format.time_control,"<br><br>\n              <strong>Rated</strong><br>").concat(d,"<br><br>\n              <strong>Entry Fees</strong><br>").concat(s,"<br><br>\n              ").concat(f,"\n            </div>\n            <div>").concat(m,'</div>\n          </div>\n          <div class="card__hilite">$').concat(events[n].registration.entry_fee.adult,"</div>\n        </div>")}document.querySelector("#flatpickr-events-details").innerHTML=e}function setEvents(){for(var t=document.querySelectorAll("[id^='events-']"),e=0;e<t.length;++e){var n=t[e].querySelectorAll(".event");0<n.length&&setEventDetailStyles(n)}}function setEventDetailStyles(t){for(var e=90,n=0;n<t.length;++n)t[n].style.transform="rotate(".concat(e,"deg) translate(").concat(18.5,"px) rotate(-").concat(e,"deg)"),e+=30}function setCalendarListeners(){for(var t=document.querySelectorAll(".flatpickr-day.cool"),e=0;e<t.length;++e)t[e].addEventListener("click",drawEventOutput,!1)}function setEventListListeners(){for(var t=document.querySelectorAll(".event-list"),e=0;e<t.length;++e)t[e].addEventListener("click",drawEventOutput,!1);for(var n=document.querySelectorAll(".toggle"),r=0;r<n.length;++r)!function(t){n[t].addEventListener("click",function(){toggleClass(n[t],"toggle")},!1)}(r);selectNearestEvent(t)}function selectNearestEvent(t){for(var e=dateToIsoDate(),n=0;n<t.length;++n)if(t[n].getAttribute("aria-label")>=e){t[n].click();break}}